# Лабораторная работа 4 
## Задачи для лабораторной: 
* использование функций для автоматизации рутинных задач;
* подгонка статистической модели;

## Требования к оформлению
* Оформить решение в R Markdown. 
* Сохранить файл в свой репозиторий.
* Выгрузить R Markdown в HTML, назвать своим именем и отправить по почте (если хочется сдать раньше или нужна помощь).

## Исходные данные
&ensp;Гамма-распределения это семейство распределений вероятности, определяемых следующей
функцией плотности вероятности:   
&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;_f(x) = (x^(a-1)⋅e^(-x/s))/(s^a)⋅Γ(a)_, где **гамма-функция Γ(a)** выбирается таким образом, что общая вероятность всех неотрицательных _x_ равняется 1.
Параметр _a_ называется форма, параметр s масштаб.
В R существует стандартная функция для получения плотности вероятности: ``dgamma()``.  
&ensp;В лабораторной работе следует удостовериться, что математическое ожидание этого распределения
равняется _a⋅s_, а дисперсия _a⋅s^2_.  
Если мат. ожидание (μ) и дисперсия (σ²) известны, тогда параметры будут равны:  
   _a = μ²/σ²_,  
   _s =  σ²/μ_  

&ensp;Необходимо выполнить подгонку гамма-распределения под данные и оценить результаты подгонки.
Данными для анализа будет встроенный в R набор данных о весе тел и сердец котов и кошек.
### Задание
1. Загрузите датафрейм _cats_ (посмотреть описание датафрейма можно при помощи команды ``help(cats)``) из пакета _MASS_, при помощи команд: ``library(MASS) data(cats)``.
2. Выполните команду ``summary(cats)`` и опишите результат.
3. Рассчитайте среднее (mean), среднеквадратичное отклонение (sd) и дисперсию (var) веса кошачьих сердец.
4. При помощи полученных значений и формул выше, рассчитайте параметры _a_ и _s_.
Округлите до разумного числа знаков.
5. Напишите функцию для расчёта параметров _a_ и _s_ через дисперсию и среднее для передаваемого вектора чисел.
Функция должна зазываться _my.gamma_ и возвращать рассчитанные параметры в виде именованного вектора.
6. Какие результаты возвращает функция для вектора весов сердец? Сходятся ли они с ответами в п. 4? Должны сходиться?
7. Постройте гистограмму весов. Добавьте на гистограмму кривую плотности вероятности при помощи функций
``curve`` и ``dgamma``, указав ранее найденные параметры формы и масштаба.
7. Получите параметры _a_ и _s_ отдельно для котов и кошек, использовав функцию _my.gamma_.
8. Постройте полученные функции распределения на одном графике, используя ``curve`` и ``dgamma``.
9. Случайным образом разделите данные на две группы одного размера равного количеству котов и кошек соответственно.
Получите гамма-параметры для обеих групп. Повторите эксперимент несколько раз.
Найдите среднюю разницу между результатами групп.
10. Какие выводы можно сделать относительно полученных распределений для кошек и котов. Есть ли разница? Поясните.